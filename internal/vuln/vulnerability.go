package vuln

import "fmt"

type Vulnerability struct {
	CVE_ID                   string
	VulnerabilityName        string
	VulnerabilityDescription string
	VulnerabilitySeverity    string
	CVSSScore                float64
	References               []string
}

func (v *Vulnerability) String() string {
	return fmt.Sprintf(
		"CVE ID: %s\nName: %s\nSeverity: %s\nCVSS Score: %.2f\nDescription: %s\nReferences:\n%s",
		v.CVE_ID,
		v.VulnerabilityName,
		v.VulnerabilitySeverity,
		v.CVSSScore,
		v.VulnerabilityDescription,
		formatReferences(v.References),
	)
}
func formatReferences(refs []string) string {
	if len(refs) == 0 {
		return "None"
	}
	result := ""
	for _, ref := range refs {
		result += fmt.Sprintf("%s\n", ref)
	}
	return result
}
